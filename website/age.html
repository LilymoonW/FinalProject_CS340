<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Age Riddle Solver</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #riddle, #solution, #verification, #userVerification {
            margin-top: 20px;
            font-size: 18px;
            color: #333;
        }
        #pixelGif {
            display: none; /* Hide it at first */
            width: 200px; /* Or whatever size you want */
            image-rendering: pixelated; /* Makes it look crispy like pixel art! */
        }
    </style>
</head>
<body>
    <h1>Age Riddle Solver</h1>
    
    <button onclick="solveRiddle()">Solve New Riddle</button> <!-- üëà Correct button call -->

    <div id="riddle"></div>
    <div id="solution"></div>
    <div id="verification"></div>

    <h2>Enter your guess:</h2>
    <input type="number" id="guess1" placeholder="First age">
    <input type="number" id="guess2" placeholder="Second age">
    <input type="number" id="guess3" placeholder="Third age">
    <button onclick="verifyGuess()">Check My Guess</button> <!-- üëà Correct button call -->
    <img id="pixelGif" src="/static/goose.gif" alt="Pixel Art">

    <div id="userVerification"></div> <!-- To show user guess result -->

    <script>
        // üåü Global Variables
        let globalAge1, globalAge2, globalAge3;
        let globalProduct, globalSum;
        let globalProductCheck, globalSumCheck;
        let globalVerificationText;

        let userGuess1, userGuess2, userGuess3;
        let userProduct, userSum;
        let userVerificationText;

        // üåü Solve Riddle (called when loading or new riddle)
        function solveRiddle() {
            fetch('/solve')
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        document.getElementById('riddle').innerText = data.error;
                        document.getElementById('solution').innerText = '';
                        document.getElementById('verification').innerText = '';
                    } else {
                        // Save into global variables
                        globalProduct = data.product;
                        globalSum = data.sum;
                        [globalAge1, globalAge2, globalAge3] = data.ages;

                        globalProductCheck = globalAge1 * globalAge2 * globalAge3;
                        globalSumCheck = globalAge1 + globalAge2 + globalAge3;

                        globalVerificationText = 
                            (globalProductCheck === globalProduct && globalSumCheck === globalSum)
                            ? "‚úÖ Verification Passed!"
                            : "‚ùå Verification Failed!";

                        // Update the riddle display
                        document.getElementById('riddle').innerText = 
                            `Find three ages where:\nProduct = ${globalProduct}, Sum = ${globalSum}`;
                        
                        console.log(`Real ages: ${globalAge1}, ${globalAge2}, ${globalAge3}`);   
                    }
                })
                .catch(error => console.error('Error:', error));
        }

        // üåü Verify User Guess
        function verifyGuess() {
            userGuess1 = parseInt(document.getElementById('guess1').value);
            userGuess2 = parseInt(document.getElementById('guess2').value);
            userGuess3 = parseInt(document.getElementById('guess3').value);

            userProduct = userGuess1 * userGuess2 * userGuess3;
            userSum = userGuess1 + userGuess2 + userGuess3;

            if (userProduct === globalProduct && userSum === globalSum) {
                userVerificationText = "‚úÖ Correct Guess!";
                showGif(); // üéØ call your gif showing function
            } else {
                userVerificationText = "‚ùå Wrong Guess.";
}

    

            // Update display
            document.getElementById('solution').innerText = 
                `Real Solution: Ages are ${globalAge1}, ${globalAge2}, ${globalAge3}`;

            document.getElementById('verification').innerText = globalVerificationText;

            // Optional: show user guess check separately
            document.getElementById('userVerification').innerText = userVerificationText;
        }

        function showGif() {
            document.getElementById('pixelGif').style.display = 'block';
        }
        
        // üåü Auto-solve when page loads
        window.onload = function() {
            solveRiddle();
        };
    </script>
</body>
</html>
