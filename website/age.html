<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Age Riddle Solver</title>
    <style>
      body {
        margin: 0;
        padding: 0;
        height: 100vh;
        font-family: Arial, sans-serif;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .container {
        background-image: url("/static/clamdoor.png");
        width: 75%;
        height: 85%; /* You can adjust this */
        margin: 10px auto 0 auto; /* Top gap + horizontally center it */
        background-size: cover; /* Fully fill container */
        background-repeat: no-repeat;
        background-position: center center;
        background-color: #f0f0f0; /* fallback color */
        border: 5px solid #3f0606; /* Border around container */
        border-radius: 5px; /* Optional: rounded corners */
        position: relative;
      }

      button {
        padding: 10px 20px;
        font-size: 16px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
      }
      button:hover {
        background-color: #45a049;
      }
      #riddle,
      #solution,
      #verification,
      #userVerification {
        margin-top: 20px;
        font-size: 18px;
        color: #333;
      }

      body {
        margin: 0;
        padding: 0;
        height: 100vh;
        font-family: Arial, sans-serif;
        position: relative;
        background-color: #f0f0f0;
      }

    /* Dialogue Box */
    #dialogue-box {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 45%;
      background-color: white;
      border-top: 2px solid #ccc;
      box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10; /* Ensure it appears above other content */
    }

      /* Inner content */
      #dialogue-content {
        text-align: center;
      }

      /* Button */
      #close-btn {
        margin-top: 20px;
        padding: 10px 20px;
        border: none;
        background-color: #007bff;
        color: white;
        border-radius: 5px;
        cursor: pointer;
      }

      #close-btn:hover {
        background-color: #0056b3;
      }
      /* Open Button */
      #open-btn {
        position: fixed;
        bottom: 20px;
        right: 20px;
        padding: 12px 18px;
        border: none;
        background-color: #28a745;
        color: white;
        border-radius: 5px;
        cursor: pointer;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }

      /* Hide open button when dialogue is open */
      #open-btn.hidden {
        display: none;
      }

      #pixelGif {
        display: none; /* Hide it at first */
        width: 200px; /* Or whatever size you want */
        image-rendering: pixelated; /* Makes it look crispy like pixel art! */
      }
    </style>
  </head>
  <body>
    <!-- 👈 Correct button call -->
    <div class="container">
      <h1>Age Riddle Solver</h1>
      <h2>Can you guess the ages?</h2>
      <div id="riddle"></div>
      <div id="solution"></div>
      <div id="verification"></div>
      '
      <h2>Enter your guess:</h2>
      <input type="number" id="guess1" placeholder="First age" />
      <input type="number" id="guess2" placeholder="Second age" />
      <input type="number" id="guess3" placeholder="Third age" />
      <button onclick="verifyGuess()">Check My Guess</button>
      <!-- 👈 Correct button call -->
      <img id="pixelGif" src="/static/goose.gif" alt="Pixel Art" />

      <div id="userVerification"></div>
      <!-- To show user guess result -->
      
      <div id="dialogue-box">
        <div id="dialogue-content">
          <p>Hello! This is a dialogue box at the bottom half of the screen.</p>
          <button id="close-btn">Close</button>
        </div>
      </div>

      <button id="open-btn">Open Dialogue</button>


    </div>
  


    <script>
      // 🌟 Global Variables
      let globalAge1, globalAge2, globalAge3;
      let globalProduct, globalSum;
      let globalProductCheck, globalSumCheck;
      let globalVerificationText;

      let userGuess1, userGuess2, userGuess3;
      let userProduct, userSum;
      let userVerificationText;

      // 🌟 Solve Riddle (called when loading or new riddle)
      function solveRiddle() {
        fetch("/solve")
          .then((response) => response.json())
          .then((data) => {
            if (data.error) {
              document.getElementById("riddle").innerText = data.error;
              document.getElementById("solution").innerText = "";
              document.getElementById("verification").innerText = "";
            } else {
              // Save into global variables
              globalProduct = data.product;
              globalSum = data.sum;
              [globalAge1, globalAge2, globalAge3] = data.ages;

              globalProductCheck = globalAge1 * globalAge2 * globalAge3;
              globalSumCheck = globalAge1 + globalAge2 + globalAge3;

              globalVerificationText =
                globalProductCheck === globalProduct &&
                globalSumCheck === globalSum
                  ? "✅ Verification Passed!"
                  : "❌ Verification Failed!";

              // Update the riddle display
              document.getElementById(
                "riddle"
              ).innerText = `Find three ages where:\nProduct = ${globalProduct}, Sum = ${globalSum}`;

              console.log(
                `Real ages: ${globalAge1}, ${globalAge2}, ${globalAge3}`
              );
            }
          })
          .catch((error) => console.error("Error:", error));
      }

      // 🌟 Verify User Guess
      function verifyGuess() {
        userGuess1 = parseInt(document.getElementById("guess1").value);
        userGuess2 = parseInt(document.getElementById("guess2").value);
        userGuess3 = parseInt(document.getElementById("guess3").value);

        userProduct = userGuess1 * userGuess2 * userGuess3;
        userSum = userGuess1 + userGuess2 + userGuess3;

        if (userProduct === globalProduct && userSum === globalSum) {
          userVerificationText = "✅ Correct Guess!";
          showGif(); // 🎯 call your gif showing function
        } else {
          userVerificationText = "❌ Wrong Guess.";
        }

        // Update display
        document.getElementById(
          "solution"
        ).innerText = `Real Solution: Ages are ${globalAge1}, ${globalAge2}, ${globalAge3}`;

        document.getElementById("verification").innerText =
          globalVerificationText;

        // Optional: show user guess check separately
        document.getElementById("userVerification").innerText =
          userVerificationText;
      }

      function showGif() {
        document.getElementById("pixelGif").style.display = "block";
      }

      // The dialogue box
      const closeBtn = document.getElementById("close-btn");
      const openBtn = document.getElementById("open-btn");
      const dialogueBox = document.getElementById("dialogue-box");

      closeBtn.addEventListener("click", () => {
        dialogueBox.style.display = "none";
        openBtn.classList.remove("hidden");
      });

      openBtn.addEventListener("click", () => {
        dialogueBox.style.display = "flex";
        openBtn.classList.add("hidden");
      });

      // When page loads, hide the open button because dialogue is showing
      window.onload = () => {
        openBtn.classList.add("hidden");
      };

      // 🌟 Auto-solve when page loads
      window.onload = function () {
        solveRiddle();
        openBtn.classList.add("hidden");
      };
    </script>
  </body>
</html>
